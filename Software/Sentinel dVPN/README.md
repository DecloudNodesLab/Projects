# Разверка Sentinel dVPN ноды 

> Для разверки ноды можете воспользоваться [веб интерфейсом Cloudmos](https://deploy.cloudmos.io/). О том, как с ним работать можете [описано в этом документе](https://github.com/DecloudNodesLab/Guides/blob/main/Russian/Cloudmos.md).

### Подготовка
1. Создайте в `Keplr` новый аккаунт для dVPN ноды.
2. Зашифруйте мнемоник фразу с помощью `BASE64`, это можно сделать как с помощью приложения `Notepad++` (Плагины-MIME Tools-Base64 Encode), либо с помощью любого безопасного онлайн шифратора Base64.
3. Пополните счет созданного dVPN аккаунта не менее чем на `150dvpn` (~$0.10) для оплаты газа. 

### Развертка узла
Откройте web интерфейс `Cloudmos`, нажмите кнопку `DEPLOY`, выберите пустой темплейт `Empty` и скопируйте туда содержимое [deploy.yml](https://raw.githubusercontent.com/DecloudNodesLab/Projects/main/Software/Sentinel%20dVPN/deploy.yml).

<p align="center"><img src="https://user-images.githubusercontent.com/23629420/221607947-cdc2b2e6-cc96-4709-9278-e15369bb62bf.gif" width=70% </p>

Нода `Sentinel dVPN` требует **выделенного IP адреса и статических внешних портов**, для этого необходимо внести небольшие изменения в манифест (deploy.yml),
а именно, присвойте `your_endpoint_name` в разделах `endpoints` и `expose` уникальное имя (только латинские символы нижнего регистра!)

Также, аполните переменные своими данными:
* `MNEMONIC_BASE64` - Мнемоник фраза от ранее созданного аккаунта sentinel защифрованная с помощью BASE64
* `MONIKER` - Имя вашей ноды, сделайте его уникальным.
* `IPV4_ADDRESS` - пока оставьте пустым.
> Если вы захотите сменить `LISTEN_PORT` или `REMOTE_PORT` - незбудьте так же внести изменения в соответвующих пунктах раздела `EXPOSE`.

<p align="center"><img src="https://user-images.githubusercontent.com/23629420/221614307-09813671-ed36-4db3-86d8-5836245f05f1.gif" width=70% </p>

До начала развертывания, мы не можем знать какой **IPv4** адрес нам будет назначен, поэтому мы начнем развертку с пустым `IPV4_ADDRESS`. Мы заполним его как только получим адрес IPv4 от провайдера и обновим наш деплой. 
Пришло время запросить текущие предложения на рынке вычислительных мощностей. Нажимаем `CREATE DEPLOYMENT`, подтверждаем транзакцию (у нас будет заморожено 5 АКТ) и дожидаем появления предложений от провайдеров.

<p align="center"><img src="https://user-images.githubusercontent.com/23629420/221620076-7829428a-5832-4ff9-ab91-215875651d5a.gif" width=70% </p>

Как вы смогли заметить всего было доступно 3 провайдера готовых предоставить вычислительные мощности с функцией статического IP. Я выбрал самого дешевого и продолжил разветывание.
В логах мы можем увидеть назначенный нам IPv4 адрес. Так же он отображается на владке LEASES нашего развертывания.
Все что нам остается - это скопировать его, вставить в наш манифест(deploy.yml) на странице UPDATE и обновить развертывание. 
Вот как это выглядит:

<p align="center"><img src="https://user-images.githubusercontent.com/23629420/221625686-4efca4c2-a3a0-4ebf-9933-09637b16d575.gif" width=70% </p>


